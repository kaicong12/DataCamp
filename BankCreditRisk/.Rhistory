install.packages("caret")
install.packages("doSNOW")
install.packages("cluster")
install.packages("tidyr")
install.packages("factoextra")
X <- read.csv(url("https://garrettgman.github.io/tidying/#:~:text=gather()%20collects%20a%20set,gather()%20to%20tidy%20table4%20.csv"))
X
View(X)
View(X)
X <- read.csv(url("http://online.wsj.com/public/resources/documents/info-Degrees_that_Pay_you_Back-sort.html?mod=article_inline.csv"))
X
View(X)
setwd("C:/Users/kctey/OneDrive/Desktop/NUS Y2S2/BT1101/Lecture/Lecture 3")
install.packages("readxl")
bank_credit_risk_data <- read_excel("Bank Credit Risk Data")
library(dplyr)
library(tidyr)
library(readxl)
bank_credit_risk_data <- read_excel("Bank Credit Risk Data")
bank_credit_risk_data <- read_excel("Bank Credit Risk Data.xlsx")
View(bank_credit_risk_data)
View(bank_credit_risk_data)
("Bank Credit Risk Data.xlsx", skip=2)
bank_credit_risk_data <- read_excel("Bank Credit Risk Data.xlsx" ,skip=2)
View(bank_credit_risk_data)
View(bank_credit_risk_data)
BD <- bank_credit_risk_data
View(bank_credit_risk_data)
head(BD)
#Customer Profile dashboard
#we are interested in information like genders, marital status, age, savings
#categorical variable, pie  charts (since there isnt too many categories)
GenderFreq <- BD %>% count(Gender)
View(GenderFreq)
gen.piepercent <- 100*round((GenderFreq$n/sum(GenderFreq$n),2))
gen.piepercent <- 100*round((GenderFreq$n/sum(GenderFreq$n)),2))
gen.piepercent <- 100*round(GenderFreq$n/sum(GenderFreq$n),2)
pie(GenderFreq$n, col=c("blue","cyan"),radius=1, main="Customer Gender")
pie(GenderFreq$n, col=c("blue","cyan"), main="Customer Gender")
pie(GenderFreq$n, col=c("blue","cyan"), main="Customer Gender")
pie(GenderFreq$n, col=c("blue","cyan"), main="Customer Gender")
pie(GenderFreq$n, col=c("blue","cyan"), radius=1 ,main="Customer Gender")
label <- GenderFreq$Gender
label <- paste(label,",",sep="")
label <- paste(label,gen.piepercent)
label <- paste(label,"%")
pie(GenderFreq$n, labels=label, col=c("blue","cyan"), radius=1 ,main="Customer Gender")
pie(GenderFreq$n, labels=label, col=c("blue","cyan"), radius=2 ,main="Customer Gender")
hist(BD$Age, main="Customer's Age", xlab="Age",ylab="Frequency",xlim=(0,100),labels=TRUE)
hist(BD$Age, main="Customer's Age", xlab="Age", ylab="Frequency", xlim=(0,100), labels=TRUE)
hist(BD$Age, main="Customer's Age", xlab="Age", ylab="Frequency", xlim=c(0,100), labels=TRUE)
hist(BD$Age, main="Customer's Age", xlab="Age", ylab="Frequency", xlim=c(10,80), labels=TRUE)
hist(BD$Age, main="Customer's Age", xlab="Age", ylab="Frequency", xlim=c(10,80), ylim=c(0,100), labels=TRUE)
plot(BD$Age,BD$Savings,main = "Scatterplot of Savings to Age", xlab="Age", ylab= "Savings")
LoanFreq <- BD %>% count(`Loan Purpose`)
View(LoanFreq)
barplot(LoanFreq$n, names.arg=LoanFreq$`Loan Purpose`, horiz=TRUE)
barplot(LoanFreq$n, names.arg=LoanFreq$`Loan Purpose`, horiz=TRUE, las=1)
barplot(LoanFreq$n, names.arg=LoanFreq$`Loan Purpose`, cex.names =0.8, horiz=TRUE, las=1)
barplot(LoanFreq$n, names.arg=LoanFreq$`Loan Purpose`,  horiz=TRUE, las=1)
cex.names =0.8,
barplot(LoanFreq$n, names.arg=LoanFreq$`Loan Purpose`, cex.names =0.8, horiz=TRUE, las=1)
BD2 <- BG %>% group_by(`Loan Purpose`,Gender) %>% tally()
BD2 <- BD %>% group_by(`Loan Purpose`,Gender) %>% tally()
BD2
#we cant plot a barplot using frequency table, the x input has to be a matrix
BD2.spread <- BD2 %>% spread(key=Gender, value=n)
barplot(BD2.spread, names.arg=c("Female","Male"),beside=TRUE, ylim=c(0,120))
barplot(BD2.spread, names.arg=c("Female","Male"), beside=TRUE, ylim=c(0,120))
barplot(BD2.spread, names.arg=c("Female","Male"), beside=TRUE)
barplot(BD2.spread, names.arg=c("Female","Male"),col=col_bar, beside=TRUE)
barmatrix <- as.matrix(BD2.spread)
barplot(BD2.spread, names.arg=c("Female","Male"),col=col_bar, beside=TRUE)
barmatrix <- as.matrix(BD2.spread[,c(2,3)])
View(barmatrix)
barplot(BD2.spread, names.arg=c("Female","Male"),col=col_bar, beside=TRUE)
barmatrix <- as.matrix(BD2.spread)
View(barmatrix)
View(barmatrix)
barplot(barmatrix, names.arg=c("Female","Male"),col=col_bar, beside=TRUE)
col_bar <- c("red","orange","yellow","green","blue","gray","pink","brown","cyan","violet")
barplot(barmatrix, names.arg=c("Female","Male"),col=col_bar, beside=TRUE)
barmatrix <- as.matrix(BD2.spread[,c(2,3)])
barplot(barmatrix, names.arg=c("Female","Male"),col=col_bar, beside=TRUE)
legend("topleft",cex=0.5, fill=col_bar)
legend("topleft",cex=0.5, fill=col_bar, BD2.spread$`Loan Purpose`)
rpivotTable(BD，rows="Loan Purpose", cols=c("Gender","Marital Status"))
install.packages("rpivotTable")
library(rpivotTable)
rpivotTable(BD，rows="Loan Purpose", cols=c("Gender","Marital Status"))
BD.sav <- BD %>% select("Savings") %>% arrange(desc(Savings))
BD.sav.percent <- BD.sav$Savings/sum(BD.sav$Savings)
BD.sav$percent <- BD.sav$Savings/sum(BD.sav$Savings)
BD.sav$cumsum <- cumsum(BD.sav$percent)
View(BD.sav)
BD.sav$Cumulative.cus <- as.numeric(rownames(BD)/nrow(BD))
BD.sav$Cumulative.cus <- as.numeric(rownames(BD)/nrow(BD))
BD.sav$Cumulative.cus <- as.numeric(rownames(BD.sav)/nrow(BD.sav))
which(BD.sav$cumsum > 0.8)
which(BD.sav$cumsum > 0.8)[1]
rownames(BD)
BD.sav$Cumulative.cus <- as.numeric(rownames(BD))/nrow(BD)
View(BD.sav)
86/nrow(BD)
